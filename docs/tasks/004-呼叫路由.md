# 004-呼叫路由 Develop Task

**状态**: Draft

---

**要实现的功能**
实现呼入路由功能，支持根据 IVR 按键或来电号码路由到指定分机

**技术栈**
- 框架: Spring Boot 3.x
- 数据库: PostgreSQL
- 通信: FreeSWITCH ESL

---

## 子任务

- [ ] 设计路由策略数据模型
  - 路由规则表 (routing_rule)
  - 策略类型（IVR按键、号码匹配、默认）
  - 规则优先级

- [ ] 实现路由策略配置 API
  - 创建路由规则
  - 查询规则列表
  - 更新规则配置
  - 启用/禁用规则

- [ ] 实现路由引擎
  - 接收呼入请求
  - 根据规则匹配策略
  - 选择目标分机
  - 执行转接操作

- [ ] 编写呼叫路由测试用例
  测试: mvn test -Dtest=RoutingServiceTest

---

## 任务目标

- [ ] API: POST /api/routing/rules - 创建路由规则成功
- [ ] API: GET /api/routing/rules - 查询规则列表成功
- [ ] API: PUT /api/routing/rules/{id} - 更新规则成功
- [ ] 呼入能正确触发路由分配
- [ ] 按配置策略选择目标分机
- [ ] 转接成功，通话建立

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
